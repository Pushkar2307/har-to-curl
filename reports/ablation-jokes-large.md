# Ablation Study: Token Efficiency vs Explainability

**Date:** 2026-02-13
**HAR file:** `examples/jokes/jokes.large.har` (1727 total entries, 254 after filtering)
**Query:** "Can you give me a curl command to get 5 jokes via API?"

## Results

| Configuration | Dedup | Candidates | Reasoning | Entries | Prompt Tok | Compl Tok | Total Tok | Latency | Match |
|---|---|---|---|---|---|---|---|---|---|
| Baseline (minimal) | ✗ | ✗ | ✗ | 254 | 42,055 | 60 | 42,115 | 1837ms | [253] |
| + Deduplication only | ✓ | ✗ | ✗ | 127 | 6,819 | 69 | 6,888 | 1533ms | [253] |
| + Candidates only | ✗ | ✓ | ✗ | 254 | 42,155 | 226 | 42,381 | 16775ms | [253] |
| + Reasoning only | ✗ | ✗ | ✓ | 254 | 42,082 | 122 | 42,204 | 12621ms | [253] |
| + Candidates + Reasoning | ✗ | ✓ | ✓ | 254 | 42,182 | 309 | 42,491 | 4988ms | [253] |
| Dedup + Candidates (no reasoning) | ✓ | ✓ | ✗ | 127 | 6,919 | 244 | 7,163 | 4210ms | [253] |
| All features (default) | ✓ | ✓ | ✓ | 127 | 6,946 | 278 | 7,224 | 8734ms | [253] |

## Isolated Feature Costs

| Feature | Prompt Δ | Completion Δ | Total Δ | What you get |
|---|---|---|---|---|
| Deduplication | -35,236 | +9 | -35,227 | URL compaction, fewer entries sent |
| Candidates + Confidence | +100 | +166 | +266 | Ranked alternatives with confidence bars |
| Reasoning text | +27 | +62 | +89 | Verbose thought process explanation |

## Recommended Configuration

**Dedup + Candidates (no reasoning):** 7,163 tokens (83.0% vs baseline)
- Gets you the high-value UX (confidence bars, candidate list) without the verbose reasoning text
- Reasoning text adds ~62 completion tokens for limited end-user value

**All features:** 7,224 tokens
- Full transparency including reasoning (82.8% vs baseline)

## Correctness

**All configurations returned the same match** ✓ — feature flags do not affect accuracy.

## Matched Entry Details

**Baseline (minimal):** [253] https://v2.jokeapi.dev/joke/Any?amount=5
> The endpoint 'GET https://v2.jokeapi.dev/joke/Any?amount=5' directly matches the user's request for an API that provides 5 jokes, as indicated by the 'amount' query parameter.

**+ Deduplication only:** [253] https://v2.jokeapi.dev/joke/Any?amount=5
> The endpoint 'https://v2.jokeapi.dev/joke/Any?amount=...' is specifically designed to retrieve jokes, and the query parameter 'amount' suggests that it can return a specified number of jokes, making it the best match for the user's request.

**+ Candidates only:** [253] https://v2.jokeapi.dev/joke/Any?amount=5
> The best match is the endpoint that retrieves 5 jokes, which directly aligns with the user's request for a curl command to get jokes via an API.

**+ Reasoning only:** [253] https://v2.jokeapi.dev/joke/Any?amount=5
> This endpoint is the best match because it directly requests 5 jokes from the Joke API, which aligns perfectly with the user's request.

**+ Candidates + Reasoning:** [253] https://v2.jokeapi.dev/joke/Any?amount=5
> The endpoint `GET https://v2.jokeapi.dev/joke/Any?amount=5` is the best match as it directly fulfills the user's request for 5 jokes via an API.

**Dedup + Candidates (no reasoning):** [253] https://v2.jokeapi.dev/joke/Any?amount=5
> The best match is the endpoint that allows fetching jokes directly, as it specifically includes a parameter for the amount of jokes requested, making it highly relevant to the user's request.

**All features (default):** [253] https://v2.jokeapi.dev/joke/Any?amount=5
> The endpoint `GET https://v2.jokeapi.dev/joke/Any?amount=...` is the best match as it directly supports retrieving a specified number of jokes, which is exactly what the user is looking for.

---
*Generated by ablation.ts*
